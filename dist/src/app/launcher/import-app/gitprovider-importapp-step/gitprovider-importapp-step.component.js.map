{"version":3,"sources":["../../../../../../src/app/launcher/import-app/gitprovider-importapp-step/gitprovider-importapp-step.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,OAAO,EAEL,SAAS,EAET,IAAI,EAGJ,SAAS,EACT,iBAAiB,EAClB,MAAM,eAAA,CAAgB;AAIvB,OAAO,EAAE,sBAAA,EAAuB,MAAO,wCAAA,CAAyC;AAChF,OAAO,EAAE,kBAAA,EAAmB,MAAO,oCAAA,CAAqC;AAExE,OAAO,EAAE,iBAAA,EAAkB,MAAO,0BAAA,CAA2B;AAC7D,OAAO,EAAE,YAAA,EAAa,MAAO,qBAAA,CAAsB;AACnD,OAAO,EAAE,SAAA,EAAU,MAAO,kCAAA,CAAmC;AAG7D;IAAuD,qDAAY;IAOjE,2CAAoB,iBAAoC,EACpC,sBAA8C,EAC9C,kBAAsC;QAF1D,YAGE,iBAAO,SACR;QAJmB,uBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,4BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,wBAAkB,GAAlB,kBAAkB,CAAoB;QALlD,mBAAa,GAAmB,EAAE,CAAC;;IAO3C,CAAC;IAED,2DAAe,GAAf;QAAA,iBAMC;QALC,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;YACvD,UAAU,CAAC;gBACT,KAAI,CAAC,aAAa,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;YAC3C,CAAC,EAAE,EAAE,CAAC,CAAC;QACT,CAAC;IACH,CAAC;IAED,oDAAQ,GAAR;QAAA,iBASC;QARC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAErC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,CAAC,SAAS,CAAC,UAAC,GAAG;YAC/E,EAAE,CAAC,CAAC,GAAG,KAAK,SAAS,CAAC,CAAC,CAAC;gBACtB,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,GAAG,GAAG,CAAC;gBACnD,KAAI,CAAC,cAAc,EAAE,CAAC;YACxB,CAAC;QACH,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,uDAAW,GAAX;QACE,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,UAAC,GAAG;YAC7B,GAAG,CAAC,WAAW,EAAE,CAAC;QACpB,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,CAAC,IAAI,CAAC,uBAAuB,KAAK,SAAS,CAAC,CAAC,CAAC;YAC/C,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;QAC7C,CAAC;IACH,CAAC;IASD,sBAAI,wDAAS;QAPb,YAAY;QAEZ;;;;WAIG;aACH;YACE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;QACzB,CAAC;;;OAAA;IAED,QAAQ;IAER;;OAEG;IAQH,yDAAa,GAAb;QACE,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;IACtD,CAAC;IAED,oDAAQ,GAAR,UAAS,EAAU,EAAE,KAAc;QACjC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACV,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,GAAG,SAAS,CAAC;QACtE,CAAC;QACD,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IACtC,CAAC;IAED;;;;OAIG;IACH,0DAAc,GAAd,UAAe,MAAkB;QAC/B,IAAI,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;QACzF,IAAI,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC;IACpD,CAAC;IAED;;OAEG;IACH,0DAAc,GAAd;QAAA,iBAkBC;QAjBC,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,IAAI,IAAI,CAAC,iBAAiB,CAAC,OAAO;YACzD,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;YAChD,GAAG,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC;YAChE,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,UAAU,GAAG,EAAE,CAAC;YAC7D,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,cAAc,GAAG,EAAE,CAAC;QACnE,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,uBAAuB,KAAK,SAAS,CAAC,CAAC,CAAC;YAC/C,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;QAC7C,CAAC;QACD,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,UAAC,GAAG;YAC1F,EAAE,CAAC,CAAC,GAAG,KAAK,SAAS,IAAI,KAAI,CAAC,iBAAiB,IAAI,KAAI,CAAC,iBAAiB,CAAC,OAAO;gBAC/E,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;gBAC/C,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,aAAa,CAAC,cAAc,GAAG,GAAG,CAAC;YACpE,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,UAAU;IAEF,qDAAS,GAAjB,UAAkB,SAAoB;QACpC,EAAE,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC;YAC5B,MAAM,CAAC,EAAE,CAAC;QACZ,CAAC;QACD,MAAM,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;IACnD,CAAC;IAED;;;;;OAKG;IACK,2DAAe,GAAvB,UAAwB,IAAY;QAClC,IAAI,MAAM,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,KAAK,SAAS,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;YACtF,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAClD,IAAI,KAAK,GAAG,CAAC,IAAI,MAAM,CAAC,MAAM,GAAG,kBAAkB,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACtF,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACtC,CAAC;QACD,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IACI,4CAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;oBACxB,aAAa,EAAE,iBAAiB,CAAC,IAAI;oBACrC,QAAQ,EAAE,uCAAuC;oBACjD,WAAW,EAAE,6CAA6C;oBAC1D,SAAS,EAAE,CAAC,6CAA6C,CAAC;iBAC3D,EAAG,EAAE;KACL,CAAC;IACF,kBAAkB;IACX,gDAAc,GAAmE,cAAM,OAAA;QAC9F,EAAC,IAAI,EAAE,iBAAiB,EAAE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,EAAG,EAAC;QACzD,EAAC,IAAI,EAAE,sBAAsB,GAAG;QAChC,EAAC,IAAI,EAAE,kBAAkB,GAAG;KAC3B,EAJ6F,CAI7F,CAAC;IACK,gDAAc,GAA2C;QAChE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,MAAM,EAAG,EAAE,EAAE;QAChD,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,eAAe,EAAG,EAAE,EAAE;KACjE,CAAC;IArFA;QAPC,SAAS,CAAC,gCAAgC,EAAE;YAC3C,yCAAyC,EAAE;gBACzC,QAAQ,EAAE,cAAc;gBACxB,UAAU,EAAE,YAAY;gBACxB,QAAQ,EAAE,OAAO;aAClB;SACF,CAAC;;;;0EAGD;IAoFH,wCAAC;CAtJD,AAsJC,CAtJsD,YAAY,GAsJlE;SAtJY,iCAAiC","file":"gitprovider-importapp-step.component.js","sourceRoot":"","sourcesContent":["import {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  Host,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { Subscription } from 'rxjs/Subscription';\n\nimport { DependencyCheckService } from '../../service/dependency-check.service';\nimport { GitProviderService } from '../../service/git-provider.service';\nimport { Selection } from '../../model/selection.model';\nimport { LauncherComponent } from '../../launcher.component';\nimport { LauncherStep } from '../../launcher-step';\nimport { broadcast } from '../../shared/telemetry.decorator';\n\n\nexport class GitproviderImportappStepComponent extends LauncherStep implements AfterViewInit, OnDestroy, OnInit {\n   form: NgForm;\n   versionSelect: ElementRef;\n\n  private subscriptions: Subscription[] = [];\n  private gitHubReposSubscription: Subscription;\n\n  constructor( public launcherComponent: LauncherComponent,\n              private dependencyCheckService: DependencyCheckService,\n              private gitProviderService: GitProviderService) {\n    super();\n  }\n\n  ngAfterViewInit() {\n    if (this.launcherComponent.summary.gitHubDetails.login) {\n      setTimeout(() => {\n        this.versionSelect.nativeElement.focus();\n      }, 10);\n    }\n  }\n\n  ngOnInit() {\n    this.launcherComponent.addStep(this);\n\n    this.subscriptions.push(this.gitProviderService.getGitHubDetails().subscribe((val) => {\n      if (val !== undefined) {\n        this.launcherComponent.summary.gitHubDetails = val;\n        this.getGitHubRepos();\n      }\n    }));\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.forEach((sub) => {\n      sub.unsubscribe();\n    });\n    if (this.gitHubReposSubscription !== undefined) {\n      this.gitHubReposSubscription.unsubscribe();\n    }\n  }\n\n  // Accessors\n\n  /**\n   * Returns indicator that step is completed\n   *\n   * @returns {boolean} True if step is completed\n   */\n  get completed(): boolean {\n    return this.form.valid;\n  }\n\n  // Steps\n\n  /**\n   * Navigate to next step\n   */\n  @broadcast('completeGitProviderStep_Import', {\n    'launcherComponent.summary.gitHubDetails': {\n      location: 'organization',\n      repository: 'repository',\n      username: 'login'\n    }\n  })\n  navToNextStep(): void {\n    this.launcherComponent.navToNextStep('GitProvider');\n  }\n\n  showStep(id: string, reset: boolean): void {\n    if (reset) {\n      this.launcherComponent.summary.gitHubDetails.repository = undefined;\n    }\n    this.launcherComponent.showStep(id);\n  }\n\n  /**\n   * Authorize GitHub account\n   *\n   * @param {MouseEvent} $event\n   */\n  connectAccount($event: MouseEvent): void {\n    let url = window.location.href + this.getParams(this.launcherComponent.currentSelection);\n    this.gitProviderService.connectGitHubAccount(url);\n  }\n\n  /**\n   * Ensure repo name is available for the selected organization\n   */\n  getGitHubRepos(): void {\n    let org = '';\n    if (this.launcherComponent && this.launcherComponent.summary &&\n       this.launcherComponent.summary.gitHubDetails) {\n      org = this.launcherComponent.summary.gitHubDetails.organization;\n      this.launcherComponent.summary.gitHubDetails.repository = '';\n      this.launcherComponent.summary.gitHubDetails.repositoryList = [];\n    }\n\n    if (this.gitHubReposSubscription !== undefined) {\n      this.gitHubReposSubscription.unsubscribe();\n    }\n    this.gitHubReposSubscription = this.gitProviderService.getGitHubRepoList(org).subscribe((val) => {\n      if (val !== undefined && this.launcherComponent && this.launcherComponent.summary &&\n        this.launcherComponent.summary.gitHubDetails) {\n        this.launcherComponent.summary.gitHubDetails.repositoryList = val;\n      }\n    });\n  }\n\n  // Private\n\n  private getParams(selection: Selection) {\n    if (selection === undefined) {\n      return '';\n    }\n    return '?selection=' + JSON.stringify(selection);\n  }\n\n  /**\n   * Helper to retrieve request parameters\n   *\n   * @param name The request parameter to retrieve\n   * @returns {any} The request parameter value or null\n   */\n  private getRequestParam(name: string): string {\n    let search = (window.location.search !== undefined && window.location.search.length > 0)\n      ? window.location.search : window.location.href;\n    let param = (new RegExp('[?&]' + encodeURIComponent(name) + '=([^&]*)')).exec(search);\n    if (param !== null) {\n      return decodeURIComponent(param[1]);\n    }\n    return null;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  encapsulation: ViewEncapsulation.None,\n  selector: 'f8launcher-gitprovider-importapp-step',\n  templateUrl: './gitprovider-importapp-step.component.html',\n  styleUrls: ['./gitprovider-importapp-step.component.less']\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: LauncherComponent, decorators: [{ type: Host }, ]},\n{type: DependencyCheckService, },\n{type: GitProviderService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'form': [{ type: ViewChild, args: ['form', ] },],\n'versionSelect': [{ type: ViewChild, args: ['versionSelect', ] },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}
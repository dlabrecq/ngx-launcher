{"version":3,"sources":["../../../../../../src/app/launcher/import-app/project-progress-importapp-nextstep/project-progress-importapp-nextstep.component.ts"],"names":[],"mappings":"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","file":"project-progress-importapp-nextstep.component.js","sourceRoot":"","sourcesContent":["import { Component, Host, Input, OnChanges, OnDestroy, OnInit, SimpleChanges, ViewEncapsulation } from '@angular/core';\n\nimport { Progress } from '../../model/progress.model';\nimport { ProjectProgressService } from '../../service/project-progress.service';\nimport { LauncherComponent } from '../../launcher.component';\n\n\nexport class ProjectProgressImportappNextstepComponent implements OnInit, OnChanges, OnDestroy {\n   statusLink: string;\n  isError = false;\n  errorMessage = '';\n  private _progress: Progress[];\n  private socket: WebSocket;\n\n  constructor( public launcherComponent: LauncherComponent,\n              private projectProgressService: ProjectProgressService) {\n  }\n\n  ngOnInit() {\n\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    const statusLink = changes['statusLink']['currentValue'];\n    if (statusLink) {\n      this.socket = this.projectProgressService.getProgress(statusLink);\n      this.socket.onmessage = (event: MessageEvent) => {\n        if (!this._progress) {\n          this._progress = [];\n          let values = JSON.parse(event.data);\n          console.log('data from Import ws', values);\n          for (let item of values) {\n            for (let key in item) {\n              if (item.hasOwnProperty(key)) {\n                let status = {key: key, description: item[key]} as Progress;\n                if (status['key'] !== 'GITHUB_CREATE' && status['key'] !== 'GITHUB_PUSHED') {\n                  this._progress.push(status);\n                }\n              }\n            }\n          }\n        } else {\n          let message = JSON.parse(event.data);\n          let data = message.data || {};\n          if (data && data.error) {\n            this.isError = true;\n            this.errorMessage = data.error;\n          } else {\n            for (let status of this._progress) {\n              if (status.key === message.statusMessage) {\n                status.completed = true;\n                if (data.location) {\n                  status.hyperText = data.location;\n                }\n                break;\n              }\n            }\n          }\n        }\n      };\n      this.socket.onerror = (error: ErrorEvent) => {\n        console.log('error in fetching messages in progress Component: Import', error);\n      };\n      this.socket.onclose = () => {\n        console.log('socket call closed in progress component in Import');\n      };\n    }\n  }\n\n  ngOnDestroy() {\n    this.closeConnections();\n  }\n\n  // Accessors\n\n  get allCompleted(): boolean {\n    if (this._progress === undefined) {\n      return false;\n    }\n    let result = true;\n    for (let i = 0; i < this._progress.length; i++) {\n      if (this._progress[i].completed !== true) {\n        result = false;\n        break;\n      }\n    }\n    return result;\n  }\n\n  get progress(): Progress[] {\n    return this._progress;\n  }\n\n  private closeConnections() {\n    if (this.socket) {\n      this.socket.close();\n    }\n  }\n\n  private reset() {\n    this.isError = false;\n    this.errorMessage = '';\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  encapsulation: ViewEncapsulation.None,\n  selector: 'f8launcher-projectprogress-importapp-nextstep',\n  templateUrl: './project-progress-importapp-nextstep.component.html',\n  styleUrls: ['./project-progress-importapp-nextstep.component.less']\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: LauncherComponent, decorators: [{ type: Host }, ]},\n{type: ProjectProgressService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'statusLink': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}